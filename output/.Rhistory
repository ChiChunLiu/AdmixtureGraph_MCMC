install.packages('rgdal')
version
install.packages("rticles")
install.packages("rticles")
library(rticles)
Sys.getenv("RSTUDIO_PANDOC")
Sys.getenv("RSTUDIO_PANDOC")
x = rnorm(10)
y = 5 + x + rnorm(10) * 0.2
lmod = lm(y ~ x)
summary(lmod)
5124460544/1000*1000
5124460544/1000/1000
install.packages('devtools') #assuming it is not already installed
library(devtools)
install_github('andreacirilloac/updateR')
library(updateR)
updateR(admin_password = 'Admin user password')
install.packages(as.vector(needed_packages))
updateR()
library(updateR)
updateR()
source('rlib6.R')
pi = 1/ncol(gt)
#devtools::install_github("stephenslab/susieR@0.9.0",build_vignettes = TRUE)
source('../pset4/rlib.R')
library(susieR)
library(susieR)
set.seed(123)
gt = load_genotype('../pset4/genotype.raw')
# STEP 1: standardize the genotype
gt = scale(gt, center = T, scale = T)
# STEP 2: simulate phenotypes
sim <- function(beta_causal, gt){
n = dim(gt)[1]
# simulate a gwas given a causal effect size
Y = gt$rs62103701_G * beta_causal[1] +
gt$rs57360893_G * beta_causal[2] +
gt$rs72984464_T * beta_causal[3] +
rnorm(n)
}
pi = 1/ncol(gt)
pi
dim(gt)
colnames(gt)
causal_index = match(names(as.data.frame(gt)), c('rs62103701_G', 'rs57360893_G', 'rs72984464_T'))
causal_index = c(which(causal_index == 1), which(causal_index == 2), which(causal_index == 3))
causal_index
colnames(gt)[causal_index]
gt
gt[, causal_index]
gt[, causal_index]
gt[, causal_index] * beta_causal
gt[, causal_index] * c(0.3, 0, -0.4)
source('rlib6.R')
pi = 1/ncol(gt)
simulate_coloc <- function(gt, alpha, pi1 = pi, pi2 = pi, causal_index = causal_index){
trait1 = sim(c(0.3, 0, -0.4), as.data.frame(gt))
trait2 = sim(c(-0.3, 0.4, 0), as.data.frame(gt))
trait1_susie = susie(gt, trait1)
trait1_pip = susie_get_pip(trait1_susie)
pip1 = trait1_pip[causal_index]
trait2_susie = susie(gt, trait2)
trait2_pip = susie_get_pip(trait2_susie)
pip2 = trait2_pip[causal_index]
coloc_prob(pip1, pip2, pi1, pi2, alpha)
}
simulate_coloc_all_alpha <- function() sapply(seq(0.01, 0.99, by = 0.01), function(x) simulate_coloc(gt, x))
out = lapply(1:3, function(x) simulate_coloc_all_alpha())
alphas = seq(0.01, 0.99, by = 0.01)
plot(alphas, out[[1]][1,], type = 'l', col = 'green', ylim = c(0, 1))
lines(alphas, out[[1]][2,], col = 'blue')
lines(alphas, out[[1]][3,], col = 'red')
alphas = seq(0.01, 0.99, by = 0.01)
plot(alphas, out[[1]][1,], type = 'l', col = 'green', ylim = c(0, 1))
lines(alphas, out[[1]][2,], col = 'blue')
out
simulate_coloc_all_alpha()
simulate_coloc(gt, 0.5)
simulate_coloc <- function(gt, alpha, pi1 = pi, pi2 = pi, causal_index = causal_index){
trait1 = sim(c(0.3, 0, -0.4), as.data.frame(gt))
trait2 = sim(c(-0.3, 0.4, 0), as.data.frame(gt))
trait1_susie = susie(gt, trait1)
trait1_pip = susie_get_pip(trait1_susie)
pip1 = trait1_pip[causal_index]
trait2_susie = susie(gt, trait2)
trait2_pip = susie_get_pip(trait2_susie)
pip2 = trait2_pip[causal_index]
coloc_prob(pip1, pip2, pi1, pi2, alpha)
}
alphas = seq(0.01, 0.99, by = 0.01)
simulate_coloc_all_alpha()
simulate_coloc_all_alpha()
simulate_coloc(gt, 0.5)
trait1 = sim(c(0.3, 0, -0.4), as.data.frame(gt))
trait2 = sim(c(-0.3, 0.4, 0), as.data.frame(gt))
trait1
trait1_susie = susie(gt, trait1)
trait1_pip = susie_get_pip(trait1_susie)
pip1 = trait1_pip[causal_index]
trait2_susie = susie(gt, trait2)
trait2_pip = susie_get_pip(trait2_susie)
pip2 = trait2_pip[causal_index]
coloc_prob(pip1, pip2, pi1, pi2, alpha)
pi1 = pi
pi2 = pi
coloc_prob(pip1, pip2, pi1, pi2, alpha)
alpha = 0.5
coloc_prob(pip1, pip2, pi1, pi2, alpha)
simulate_coloc <- function(gt, alpha, pi1 = pi, pi2 = pi, causal_index = causal_index){
# pi1 = pi
# pi2 = pi
# alpha = 0.5
trait1 = sim(c(0.3, 0, -0.4), as.data.frame(gt))
trait2 = sim(c(-0.3, 0.4, 0), as.data.frame(gt))
trait1_susie = susie(gt, trait1)
trait1_pip = susie_get_pip(trait1_susie)
pip1 = trait1_pip[causal_index]
trait2_susie = susie(gt, trait2)
trait2_pip = susie_get_pip(trait2_susie)
pip2 = trait2_pip[causal_index]
coloc_prob(pip1, pip2, pi1, pi2, alpha)
}
simulate_coloc(gt, 0.5)
simulate_coloc <- function(gt, alpha, pi1 = pi, pi2 = pi, causal_index = causal_index){
# pi1 = pi
# pi2 = pi
# alpha = 0.5
trait1 = sim(c(0.3, 0, -0.4), as.data.frame(gt))
trait2 = sim(c(-0.3, 0.4, 0), as.data.frame(gt))
trait1_susie = susie(gt, trait1)
trait1_pip = susie_get_pip(trait1_susie)
pip1 = trait1_pip[causal_index]
trait2_susie = susie(gt, trait2)
trait2_pip = susie_get_pip(trait2_susie)
pip2 = trait2_pip[causal_index]
coloc_prob(pip1, pip2, pi1, pi2, alpha)
}
install.packages(ape)
install.packages('ape')
library(ape)
all.equal.phylo
rexp(10)
rexp(1, 10)
rexp(1, 10)
rexp(1, 10)
mean(rbeta(100000, 0.3, 1-0.3))
curve(function (x) dbeta(x, 0.3,0.7))
curve(Vectorize(function (x) dbeta(x, 0.3,0.7)))
f = function(x) Vectorize(function (x) dbeta(x, 0.3,0.7))
curve(f)
f = function(x) Vectorize(function (x) dbeta(x, 0.3,0.7))
curve(f)
f = Vectorize(function (x) dbeta(x, 0.3,0.7))
curve(f)
f = Vectorize(function (x) dbeta(x, 3,7))
curve(f)
f = Vectorize(function (x) dbeta(x, 6,14))
curve(f)
f = Vectorize(function (x) dbeta(x, 9,21))
curve(f)
library(ggplot2)
library(tidyverse)
library(gridExtra)
setwd('~/Desktop/workspace/AdmixtreGraph2020/output/')
parameter_df = list()
for (i in 1:100){
parameter_df[[i]] = read_tsv(paste0('standard_rep', i, '.txt'),
col_names = c('rep', 'par', 'val'))
}
parameter_df = bind_rows(parameter_df)
pars = unique(parameter_df$par)
true_pars = tibble(par = pars,
val = c(8.5e4,2e5,5e5,0.3,4e4,4e4))
plots = list()
for (i in seq_along(pars)){
p = pars[i]
true_val = unlist(true_pars %>% filter(par == p) %>% select(val))
print(p)
print(true_val)
plots[[i]] <- parameter_df %>%
filter(par == p) %>%
ggplot(., aes(x=val)) +
geom_histogram() +
geom_vline(data = true_pars %>% filter(par == p),
aes(xintercept=val),
color="blue", linetype="dashed", size=1) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45)) +
ggtitle(p)
}
do.call("grid.arrange", c(plots, ncol= 3))
parameter_df = list()
for (i in 1:100){
if (file.exists(paste0('standard_rep', i, '.txt'))){
parameter_df[[i]] = read_tsv(paste0('standard_rep', i, '.txt'),
col_names = c('rep', 'par', 'val'))
}
}
parameter_df = bind_rows(parameter_df)
pars = unique(parameter_df$par)
true_pars = tibble(par = pars,
val = c(8.5e4,2e5,5e5,0.3,4e4,4e4))
plots = list()
for (i in seq_along(pars)){
p = pars[i]
true_val = unlist(true_pars %>% filter(par == p) %>% select(val))
print(p)
print(true_val)
plots[[i]] <- parameter_df %>%
filter(par == p) %>%
ggplot(., aes(x=val)) +
geom_density() +
geom_vline(data = true_pars %>% filter(par == p),
aes(xintercept=val),
color="blue", linetype="dashed", size=1) +
theme(plot.title = element_text(hjust = 0.5),
axis.text.x = element_text(angle = 45)) +
ggtitle(p)
}
do.call("grid.arrange", c(plots, ncol= 3))
n = seq(1, 5)
p = seq(1, 10)
expand.grid(n, p)
n = seq(1, 12)
p = seq(1, 12)
expand.grid(n, p)
